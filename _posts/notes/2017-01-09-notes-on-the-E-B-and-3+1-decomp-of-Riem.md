---
title: "Notes on the Weyl, E/B, and 3+1 decompositions of Riemann, and curvature invariants"
modified:
categories: [notes]
excerpt: "The Weyl decomposition, further splitting into E/B, and computing in terms of 3+1 objects"
tags: [geometry]
date: 2017-01-09T22:32:00-08:00
modified:
---

{% include toc %}

More notes I had that needed to live somewhere.  I hope you find them
useful.

# Weyl decomposition

The most basic ingredient here is splitting the Riemann tensor into
trace and tracefree pieces.  This should be covered in every standard
GR textbook (see e.g. Wald[^1]).  The decomposition is, in $$n$$
dimensions,
<div>
\begin{align}
\label{eq:R-decomp-1}
R_{abcd} = C_{abcd} + \frac{2}{n-2}( g_{a[c} R_{d]b} - g_{b[c} R_{d]a})
- \frac{2}{(n-1)(n-2)}R g_{a[c} g_{d]b} \,,
\end{align}
</div>
where $$C_{abcd}$$ is the tracefree Weyl tensor, and as usual, the
Ricci tensor is $$R_{bd} = R^a{}_{bad}$$ and the Ricci scalar is $$R =
g^{ab}R_{ab}$$.

Now, this is not a very pleasant expression to remember.  It can be
brought into a slightly nicer form by defining an 'impose index
symmetry' operation with some group $$G$$, which is a subgroup of the
[signed permutation group](https://groupprops.subwiki.org/wiki/Signed_symmetric_group)
(signed symmetric group / hyperoctahedral group), which is just the
symmetric group $$S_n$$ where each
permutation is further given a sign, $$\pm 1$$.  The 'Riemann
symmetric' group $$r[abcd]$$ is generated by the elements $$\{ -(ab),
-(cd), +(ac)(bd) \}$$.  That is, the Riemann tensor $$R_{abcd}$$ is
separately antisymmetric on $$ab$$, separately antisymmetric on
$$cd$$, and symmetric under the *simultaneous* interchange of
$$ab\leftrightarrow cd$$.  You can check that $$r[abcd]$$ is a group
with 8 elements.

The 'impose index symmetry' operation on a tensor expression
$$T_{i\cdots}$$ is given by
<div>
\begin{align}
\label{eq:impose-sym-def}
(S_G T)_{i\cdots} =
\frac{1}{|G|} \sum_{g\in G} z(g) T_{g\circ i\cdots} \,
\end{align}
</div>
where $$|G|$$ is the order of the group, $$z(g)$$ is the sign
(+1 or -1) associated with the element $$g$$, and $$g\circ i\cdots$$
means to permute indices $$i\cdots$$ as specified by the permutation
$$g$$.  This is a generalization of the symmetrization $$(ab)$$ and
antisymmetrization $$[abc]$$ operations that are commonly used,
corresponding to respectively the whole symmetric group with all plus
signs, or the whole symmetric group where signs $$z(g)=sgn(g)$$ are
determined by the parity of the permutation $$g$$.  This general
operation is implemented in [xAct](http://www.xact.es/) as
`ImposeSymmetry[]`.

Having defined this operation, we can (slightly) improve
Eq. \eqref{eq:R-decomp-1} via
<div>
\begin{align}
\label{eq:R-decomp-proj}
R_{abcd} = S_{r[abcd]} \left[
C_{abcd}
+ \frac{4}{n-2} R_{ac}g_{bd}
- \frac{2}{(n-1)(n-2)} R g_{ac}g_{bd}
\right] \,.
\end{align}
</div>

# Curvature invariants 1

Each of the Weyl/Ricci tensor/Ricci scalar pieces of the decomposition
are orthogonal to each other in the following way.  Construct the
*Kretschmann invariant*, $$K\equiv R_{abcd}R^{abcd}$$.  In terms of the
Weyl decomposition, it is given by
<div>
\begin{align}
\label{eq:K-Weyl-decomp}
K = C_{abcd}C^{abcd}
+ \frac{4}{n-2} R_{ab}R^{ab}
- \frac{2}{(n-1)(n-2)}R^2 \,.
\end{align}
</div>
Note: the coefficients in Eq. \eqref{eq:K-Weyl-decomp} are the same as
those appearing in Eq. \eqref{eq:R-decomp-proj}.  This has something
to do with the impose-symmetry operation being a properly normalized
idempotent projection operation.  In this case, it is actually a Young
projector for the standard Young tableau filled with
\{\{1,3\},\{2,4\}\}.

From here forward we focus on dimension $$n=4$$.  Now we can also
define the (left) dual Riemann tensor, via
<div>
\begin{align}
{}^*\!R^{ab}{}_{cd} \equiv \frac{1}{2}\epsilon^{abef}R_{efcd} \,.
\end{align}
</div>
With this dual, we can define the *Pontryagin invariant*,
<div>
\begin{align}
P \equiv {}^*\!R^{abcd} R_{abcd} ={}^*\!C^{abcd} C_{abcd} \,,
\end{align}
</div>
where $${}^*\!C^{abcd}$$ is the (left) dual Weyl tensor, defined in the
same way as the dual to Riemann.  Interestingly, the Pontryagin is
completely insensitive to the Ricci tensor.

For future purposes, we will also define a complex tensor where the
real part is Weyl and the imaginary part is the (left) dual of Weyl,
<div>
\begin{align}
\tilde{C}_{abcd} \equiv C_{abcd} + i {}^*\! C_{abcd} \,.
\end{align}
</div>
The square of this tensor contains both Kretschmann (minus the Ricci
parts) and Pontryagin:
<div>
\begin{align}
\tilde{C}_{abcd} \tilde{C}^{abcd} = 2 ( C_{abcd} C^{abcd}
+ i {}^*\!C_{abcd} C^{abcd} ) \,.
\end{align}
</div>

This quantity is related to the so-called $$I$$ invariant which is
usually defined in spinor language (see e.g. Stephani et al.[^2]).  The completely symmetric 'Weyl
spinor' $$\Psi_{(ABCD)}$$ related to the tensor $$\tilde{C}$$ is
<div>
\begin{align}
\label{eq:tilde-C-to-spinor}
\tilde{C}_{abcd} =
2\Psi_{ABCD} \varepsilon_{\dot{A}\dot{B}} \varepsilon_{\dot{C}\dot{D}}
\,,
\end{align}
</div>
where tensor indices $$a, b, c, d$$ are related to spinor index pairs
$$A\dot{A}, B\dot{B}$$ and so on.  In other words, the soldering form
(or van der Waerden symbols)
$$\sigma^a{}_{A\dot{A}}\sigma^b{}_{B\dot{B}}\cdots$$ are to be
inferred on the LHS of Eq. \eqref{eq:tilde-C-to-spinor}.

The aforementioned $$I$$ invariant is given by
<div>
\begin{align}
\label{eq:I-inv-def}
I &\equiv \frac{1}{2} \Psi_{ABCD} \Psi^{ABCD} =
\frac{1}{32} \tilde{C}_{abcd} \tilde{C}^{abcd} \\
I &=
\frac{1}{2}(
\Psi_0 \Psi_4 - 4 \Psi_1 \Psi_3 + 6 \Psi_2^2
- 4 \Psi_1 \Psi_3
+ \Psi_0 \Psi_4
)
\,,
\end{align}
</div>
where the Weyl scalars in some spinor dyad basis
$$\{ o^A, \iota^A \}$$
are defined as usual (the subscript counts the number of $$\iota$$'s
contracted into the spinor),
<div>
\begin{align}
\Psi_0 &= \Psi_{oooo} \,, & \Psi_1 &= \Psi_{ooo\iota} \,, \\
\Psi_2 &= \Psi_{oo\iota\iota} \,, & \Psi_3 &= \Psi_{o\iota\iota\iota} \,, \\
\Psi_4 &= \Psi_{\iota\iota\iota\iota} \,.
\end{align}
</div>

Similarly, for the $$J$$ invariant,
<div>
\begin{align}
J &\equiv \frac{1}{6} \Psi_{ABCD} \Psi^{CDEF} \Psi_{EF}{}^{AB}
= \frac{1}{384} \tilde{C}_{abcd} \tilde{C}^{cdef}
\tilde{C}_{ef}{}^{ab}
\,, \\
J &=
 \Psi_0 \Psi_2 \Psi_4
+ 2 \Psi_1 \Psi_2 \Psi_3
- \Psi_0 \Psi_3^2
- \Psi_1^2 \Psi_4
- \Psi_2^3
\,.
\end{align}
</div>
A mnemonic for remembering $$J$$ in terms of the Weyl scalars is given
by the determinant expression
<div>
\begin{align}
J = \left|
\begin{matrix}
\Psi_0 & \Psi_1 & \Psi_2 \\
\Psi_1 & \Psi_2 & \Psi_3 \\
\Psi_2 & \Psi_3 & \Psi_4
\end{matrix}
\right| \,.
\end{align}
</div>

<script type="math/tex">
\newcommand{\lie}{\mathcal{L}}
\newcommand{\Rf}{ {}^{(4)}\!R}
\newcommand{\Rt}{ {}^{(3)}\!R}
\newcommand{\cd}{\nabla}
</script>

# 3+1 and electric/magnetic decomposition

Now let us suppose we have a 3+1 decomposition of the spacetime,
i.e. that (a region of) the spacetime is foliated by spacelike
hypersurfaces (see standard references on this topic, e.g. Baumgarte
and Shapiro[^3]).  We have a timelike unit normal $$n^a$$, with
$$n^a n_a = -1$$.  This induces a splitting of the tangent spaces into
time components (parallel to $$n$$) and 'spatial' components
(orthogonal to $$n$$).  We have the spatial metric induced on the
spatial hypersurface $$\gamma_{ab}$$, with $$\gamma_{ab}n^b = 0$$,
given by
<div>
\begin{align}
g_{ab} = \gamma_{ab} - n_a n_b \,.
\end{align}
</div>
The metric-compatible derivative of $$g_{ab}$$ is $$\cd_a$$, the
metric-compatible derivative of $$\gamma_{ab}$$ is $$D_a$$, the
extrinsic curvature is $$K_{ab} = -\frac{1}{2}\lie_n \gamma_{ab}$$.

To avoid confusion, we will now label the 4-Riemann (and 4-Ricci) with
$$\Rf$$, and the 3-Riemann (and 3-Ricci, a.k.a. "thricci") with
$$\Rt$$.

We can now decompose all 4-dimensional objects using this splitting of
the tangent bundle.  We will need to split the 4-dimensional volume
form, via (Warning: conventions may vary!)
<div>
\begin{align}
\epsilon_{abcd} &= -4 n_{[a} \epsilon_{bcd]} \,, &
\epsilon_{abc} &= n^d \epsilon_{dabc} \,.
\end{align}
</div>
There is no need for 3/4 superscripts because just reading the number
of indices tells you whether this is the 3-volume or 4-volume form.

Now we proceed to splitting the Weyl tensor into space- and time
pieces.  This proceeds by analogy to the Maxwell tensor.  The
"electric" part of Weyl is defined via
<div>
\begin{align}
\label{eq:E-def}
E_{ab} \equiv C_{acbd} n^c n^d \,,
\end{align}
</div>
while the "magnetic" part of Weyl is defined via (Warning: conventions
may vary!)
<div>
\begin{align}
\label{eq:B-def}
B_{ab} \equiv {}^*\!C_{acbd} n^c n^d \,.
\end{align}
</div>
From these two it is obvious that
<div>
\begin{align}
\tilde{C}_{acbd} n^c n^d = E_{ab} + i B_{ab} \,.
\end{align}
</div>
Each of $$E_{ab}$$ and $$B_{ab}$$ are symmetric and trace-free spatial
tensors.  This is as far as you can decompose Weyl without imposing
additional structure (like some preferred direction).

We can re-express Weyl in terms of $$E_{ab}$$, $$B_{ab}$$, the
timelike unit vector and spatial metric, and 3-epsilon tensor.  I
don't know if there is a clever way to do this other than to take the
below expression and verify that it's correct.  Let me know if you
have some better insight.  Regardless, the most compact way of writing
this is again using the above 'impose index symmetry' operation
$$S_G$$ in Eq. \eqref{eq:impose-sym-def} with $$G=r[abcd]$$, the index
symmetries of Riemann.  The expression is (thanks to Alfonso
García-Parrado Gómez-Lobo)
<div>
\begin{align}
\label{eq:weyl-in-E-B}
C_{abcd} = S_{r[abcd]} \left[
4 E_{ac} (\gamma_{bd} + n_b n_d)
+ \epsilon_{ab}{}^e n_d B_{ce}
\right] \,.
\end{align}
</div>

# Curvature invariants 2

Obviously we would like to express curvature invariants in terms of
the electric and magnetic Weyl tensors.  This is a snap if you use
xTensor (otherwise there is a lot of algebra).  The relationship is
<div>
\begin{align}
I &= \frac{1}{2} (E_{ab}E^{ab}-B_{ab}B^{ab}) + i E_{ab}B^{ab} \,, \\
I &= \frac{1}{2} (E_{ab} + i B_{ab})( E^{ab} + i B^{ab} ) \,.
\end{align}
</div>
Now it is easy to see that Weyl squared and Pontryagin are simply
<div>
\begin{align}
\label{eq:Weyl-squared-in-E-B}
C_{abcd} C^{abcd} &= 8 (E_{ab}E^{ab}-B_{ab}B^{ab}) \,, \\
{}^*C_{abcd} C^{abcd} &= 16 E_{ab} B^{ab} \,.
\end{align}
</div>
Kretshmann of course also adds the 4-Ricci terms to
Eq. \eqref{eq:Weyl-squared-in-E-B}, via the relationship in
Eq. \eqref{eq:K-Weyl-decomp}.

Similarly, the $$J$$ invariant turns out to be
<div>
\begin{align}
J = \frac{-1}{6}
(E^a{}_b + i B^a{}_b)(E^b{}_c + i B^b{}_c)(E^c{}_a + i B^c{}_a)
\,.
\end{align}
</div>

# Computing from Gauss-Codazzi relations

Let's suppose you have at your disposal a numerical relativity
codebase (such as [SpEC](https://www.black-holes.org/SpEC.html)) and
thus you have access to the 3-metric $$\gamma_{ab}$$, extrinsic
curvature $$K_{ab}$$, the 3-Ricci $$\Rt_{ab}$$ and 4-Ricci
$$\Rf_{ab}$$; and you would like to compute $$E_{ab}$$ and
$$B_{ab}$$.  Certainly you should not attempt to construct the full
Riemann or Weyl tensors, because they have 256 numbers per grid point
but there are only 10 algebraically independent components in
$$E_{ab}$$ and $$B_{ab}$$!

Therefore we would like an expression for how to compute $$E_{ab}$$
and $$B_{ab}$$ in terms of the available quantities, without all the
overhead of computing Riemann or Weyl.  To do so requires using the
[Gauss-Codazzi equations](https://en.wikipedia.org/wiki/Gauss%E2%80%93Codazzi_equations) (see
e.g. Baumgarte and Shapiro[^3] for a didactic exposition).  The Gauss
and Codazzi equations relate the orthogonal decomposition of the
4-curvature to the intrinsic and extrinsic curvature of the
spatial submanifold.  These are implemented
in [xAct](http://www.xact.es/) with the command `GaussCodazzi[]`.

The Gauss equation relates the completely spatial projection,
<div>
\begin{align}
\label{eq:Gauss-eq}
\gamma_a^p \gamma_b^q \gamma_c^r \gamma_d^s \Rf_{pqrs}
=
\Rt_{abcd} + K_{ac}K_{bd} - K_{ad}K_{bc} \,.
\end{align}
</div>
The recipe for finding a formula for $$E_{ab}$$ is as follows:

1. Use the 4-metric $$g^{ac}$$ to trace over two indices
2. Use the Weyl decomposition \eqref{eq:R-decomp-1} for $$\Rf$$ on the
   left hand side
3. Insert the E/B decomposition \eqref{eq:weyl-in-E-B} for the Weyl
   tensor on the left hand side
4. You should now have $$E_{bd}$$ with free indices and no prefactor

I highly recommend using [xAct](http://www.xact.es/) for this
calculation, to avoid errors.  The result is
<div>
\begin{align}
E_{ab} =& 
  K_{ab} K^c_c
- K_a^c K_{bc}
+ \Rt_{ab} \nonumber \\
&
- \frac{1}{2} \gamma_a^c \gamma_b^d \Rf_{cd}
- \frac{1}{2} \gamma_{ab} \gamma^{cd} \Rf_{cd}
+ \frac{1}{3} \gamma_{ab} \Rf \,.
\end{align}
</div>
The three terms on the second line all vanish when in a 4-Ricci-flat
manifold, e.g. in vacuum in GR.

To find an expression for the magnetic part $$B_{ab}$$ involves the
Codazzi equation.  This is the decomposition of 4-Riemann when one
index is contracted with $$n^a$$ and the remaining three are projected
onto spatial directions.  The Codazzi equation is
<div>
\begin{align}
\gamma_a^p \gamma_b^q \gamma_c^r n^s \Rf_{pqrs}
=
D_b K_{ac} - D_a K_{bc} \,.
\end{align}
</div>
The recipe for finding a formula for $$B_{ab}$$ is as follows:

1. Contract with the 3-epsilon $$\epsilon_d{}^{bc}$$
2. Use the Weyl decomposition \eqref{eq:R-decomp-1} for $$\Rf$$ on the
   left hand side
3. Insert the E/B decomposition \eqref{eq:weyl-in-E-B} for the Weyl
   tensor on the left hand side
4. Symmetrize on indices $$(a,d)$$
5. You should now have $$B_{ad}$$ with free indices and no prefactor

Once again you should use [xAct](http://www.xact.es/).  The result is simply
<div>
\begin{align}
B_{ab} = \epsilon_{cd(a} D^c K_{b)}{}^d \,.
\end{align}
</div>

# References

[^1]: [Wald's General Relativity](http://press.uchicago.edu/ucp/books/book/chicago/G/bo5952261.html)
[^2]: [Stephani et al.'s Exact Solutions of Einstein's Field Equations](https://doi.org/10.1017/CBO9780511535185)
[^3]: [Baumgarte and Shapiro's Numerical Relativity](http://www.cambridge.org/us/academic/subjects/physics/cosmology-relativity-and-gravitation/numerical-relativity-solving-einsteins-equations-computer?format=HB)
